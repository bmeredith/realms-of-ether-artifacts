{"language":"Solidity","sources":{"contracts/reconstructed/FortressStorageProxy.sol":{"content":"pragma solidity 0.4.18;\n\nimport {IFortressStorage} from \"./interfaces/IFortressStorage.sol\";\n\n/// @title FortressStorageProxy for Realms of Ether (https://www.realmsofether.com)\n/// @notice Reconstructed by wilt.eth/@wilty_stilty\n///\n/// @notice Logic library contract for fortress management in Realms of Ether.\n/// Called via delegatecall from the main game contract, allowing the main\n/// game contract to interact with FortressStorage using its own execution context.\n/// Also provides read-only convenience functions (getFortress, getResources)\n/// that can be called directly.\n///\n/// @dev RECONSTRUCTION NOTICE: The original source code for this contract was lost.\n/// This file has been reconstructed in its entirety from the deployed bytecode.\ncontract FortressStorageProxy {\n    function getIndexLength(\n        address _fortressStorage, \n        address _user\n    ) \n        public\n        payable \n        returns (uint256)\n    {\n        return IFortressStorage(_fortressStorage).getIndexLength(_user);\n    }\n\n    function getFortress(\n        address _fortressStorage, \n        bytes32 _fortressHash\n    ) \n        public \n        payable \n        returns (\n            bytes16,\n            address,\n            int256,\n            int256,\n            uint256\n        )\n    { \n        return (\n            IFortressStorage(_fortressStorage).getName(_fortressHash),\n            IFortressStorage(_fortressStorage).getOwner(_fortressHash),\n            IFortressStorage(_fortressStorage).getX(_fortressHash),\n            IFortressStorage(_fortressStorage).getY(_fortressHash),\n            IFortressStorage(_fortressStorage).getWins(_fortressHash)\n        );\n    }\n\n    /// @notice Sets fortress ownership to an arbitrary address. Used by the\n    /// auction system to escrow fortresses into the game contract on auction\n    /// start, and release them to the winning bidder on auction end.\n    function setOwner(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        address _newOwner\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setOwner(_fortressHash, _newOwner);\n    }\n\n    function setGold(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        uint256 _amount\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setGold(_fortressHash, _amount);\n    }\n\n    function getFortressesAvailable(address _fortressStorage)\n        public \n        payable \n        returns (uint256)\n    { \n        return IFortressStorage(_fortressStorage).getFortressesAvailable();\n    }\n\n    function getFortressCount(address _fortressStorage) \n        public \n        payable \n        returns (uint256)\n    { \n        return IFortressStorage(_fortressStorage).getFortressCount();\n    }\n\n    function getBuilding(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        bytes32 _buildingHash\n    ) \n        public \n        payable \n        returns (\n            uint256,\n            uint256\n        )\n    { \n        return (\n            IFortressStorage(_fortressStorage)\n                .getBuildingLevel(_fortressHash, _buildingHash),\n            IFortressStorage(_fortressStorage)\n                .getBuildingTimeout(_fortressHash, _buildingHash)\n        );\n    }\n\n    function getHashFromIndex(\n        address _fortressStorage, \n        address _user, \n        uint256 _index\n    ) \n        public\n        payable \n        returns (bytes32)\n    { \n        return IFortressStorage(_fortressStorage)\n            .getHashFromIndex(_user, _index);\n    }\n\n    function setTroups(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        bytes32 _troupHash, \n        uint256 _amount\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage)\n            .setTroups(_fortressHash, _troupHash, _amount);\n    }\n\n    function getResources(\n        address _fortressStorage, \n        bytes32 _fortressHash\n    ) \n        public \n        payable \n        returns (\n            uint256,\n            uint256,\n            uint256\n        )\n    { \n        return (\n            IFortressStorage(_fortressStorage).getGold(_fortressHash),\n            IFortressStorage(_fortressStorage).getStone(_fortressHash),\n            IFortressStorage(_fortressStorage).getWood(_fortressHash)\n        );\n    }\n\n    function getOwner(\n        address _fortressStorage, \n        bytes32 _fortressHash\n    ) \n        public \n        payable \n        returns (address)\n    { \n        return IFortressStorage(_fortressStorage).getOwner(_fortressHash);\n    }\n\n    /// @notice Updates fortress resources and building level after a build action.\n    /// _gold, _stone, _wood are the post-deduction balances, not the costs.\n    function build(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        bytes32 _buildingHash, \n        uint256 _gold, \n        uint256 _stone, \n        uint256 _wood, \n        uint256 _level\n    )\n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setGold(_fortressHash, _gold);\n        IFortressStorage(_fortressStorage).setStone(_fortressHash, _stone);\n        IFortressStorage(_fortressStorage).setWood(_fortressHash, _wood);\n        IFortressStorage(_fortressStorage)\n            .setBuildingLevel(_fortressHash, _buildingHash, _level);\n    }\n\n    function setStone(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        uint256 _amount\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setStone(_fortressHash, _amount);\n    }\n\n    function upgrade(address proxy, address implementation)\n        public \n        payable \n    { \n        IFortressStorage(proxy).transferOwnership(implementation);\n    }\n\n    function setWood(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        uint256 _amount\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setWood(_fortressHash, _amount);\n    }\n\n    /// @notice Transfers fortress ownership directly between players.\n    /// Called by transferFortress() in the main game contract.\n    function transfer(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        address _newOwner\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).setOwner(_fortressHash, _newOwner);\n    }\n\n    function createFortress(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        bytes16 _name, \n        int256 _x, \n        int256 _y, \n        uint256 _gold, \n        uint256 _stone, \n        uint256 _wood, \n        uint256 _wins, \n        address _user\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).createFortress(_fortressHash, _user);\n        IFortressStorage(_fortressStorage).setName(_fortressHash, _name);\n        IFortressStorage(_fortressStorage).setX(_fortressHash, _x);\n        IFortressStorage(_fortressStorage).setY(_fortressHash, _y);\n        IFortressStorage(_fortressStorage).setGold(_fortressHash, _gold);\n        IFortressStorage(_fortressStorage).setStone(_fortressHash, _stone);\n        IFortressStorage(_fortressStorage).setWood(_fortressHash, _wood);\n        IFortressStorage(_fortressStorage).setWins(_fortressHash, _wins);\n    }\n\n    function startMinting(address _fortressStorage) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage).startMinting();\n    }\n\n    function setBuildingTimeout(\n        address _fortressStorage,\n        bytes32 _fortressHash, \n        bytes32 _buildingHash, \n        uint256 _timeout\n    ) \n        public \n        payable \n    { \n        IFortressStorage(_fortressStorage)\n            .setBuildingTimeout(_fortressHash, _buildingHash, _timeout);\n    }\n\n    function getTroups(\n        address _fortressStorage, \n        bytes32 _fortressHash, \n        bytes32 _troupHash\n    ) \n        public \n        payable \n        returns (uint256)\n    { \n        return IFortressStorage(_fortressStorage).getTroups(_fortressHash, _troupHash);\n    }\n\n    function() public payable {\n        revert();\n    }\n}"},"contracts/reconstructed/interfaces/IFortressStorage.sol":{"content":"pragma solidity 0.4.18;\n\ninterface IFortressStorage {\n    function createFortress(bytes32 _fortressHash, address _user) external;\n    function startMinting() external;\n    function setName(bytes32 _fortressHash, bytes16 _name) external;\n    function setOwner(bytes32 _fortressHash, address _newOwner) external;\n    function setX(bytes32 _fortressHash, int256 _x) external;\n    function setY(bytes32 _fortressHash, int256 _y) external;\n    function setWins(bytes32 _fortressHash, uint256 _wins) external;\n    function setGold(bytes32 _fortressHash, uint256 _amount) external;\n    function setStone(bytes32 _fortressHash, uint256 _amount) external;\n    function setWood(bytes32 _fortressHash, uint256 _amount) external;\n    function setBuildingLevel(bytes32 _fortressHash, bytes32 _buildingHash, uint256 _level) external;\n    function setBuildingTimeout(bytes32 _fortressHash, bytes32 _buildingHash, uint256 _timeout) external;\n    function setTroups(bytes32 _fortressHash, bytes32 _troupHash, uint256 _amount) external;\n    function getName(bytes32 _fortressHash) external returns (bytes16);\n    function getOwner(bytes32 _fortressHash) external returns (address);\n    function getX(bytes32 _fortressHash) external returns (int256);\n    function getY(bytes32 _fortressHash) external returns (int256);\n    function getWins(bytes32 _fortressHash) external returns (uint256);\n    function getFortressesAvailable() external returns (uint256);\n    function getFortressCount() external returns (uint256);\n    function getGold(bytes32 _fortressHash) external returns (uint256);\n    function getStone(bytes32 _fortressHash) external returns (uint256);\n    function getWood(bytes32 _fortressHash) external returns (uint256);\n    function getBuildingLevel(bytes32 _fortressHash, bytes32 _buildingHash) external returns (uint256);\n    function getBuildingTimeout(bytes32 _fortressHash, bytes32 _buildingHash) external returns (uint256);\n    function getTroups(bytes32 _fortressHash, bytes32 _troupHash) external returns (uint256);\n    function getIndexLength(address _user) external returns (uint256);\n    function getHashFromIndex(address _user, uint256 _index) external returns (bytes32);\n    function transferOwnership(address newOwner) external;\n}\n"}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"useLiteralContent":false},"outputSelection":{"*":{"*":["abi","evm.bytecode.object","evm.bytecode.sourceMap","evm.bytecode.linkReferences","evm.deployedBytecode.object","evm.deployedBytecode.sourceMap","evm.deployedBytecode.linkReferences","evm.deployedBytecode.immutableReferences","evm.methodIdentifiers","metadata"]}},"libraries":{}}}
